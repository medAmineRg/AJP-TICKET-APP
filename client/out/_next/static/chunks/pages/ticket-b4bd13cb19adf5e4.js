(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[675],{8471:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ticket",function(){return n(5356)}])},9725:function(e,t,n){"use strict";var r=n(5893),a=n(2892),s=n.n(a);t.Z=function(e){var t=e.placeholder,n=e.onClick,a=e.color,i=e.bg,o=e.classN;return(0,r.jsx)("button",{style:{color:a,backgroundColor:i},onClick:n,className:o?s()[o]:s().btn,children:t})}},9501:function(e,t,n){"use strict";var r=n(5893),a=(n(7294),n(9725)),s=n(6591),i=n.n(s);t.Z=function(e){var t=e.open,n=e.children,s=e.onClose,o=e.submit,l=e.setRemove,c=e.z,u=e.isOwner,d=e.btnTxt;return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{zIndex:c},className:i().overlay}),(0,r.jsxs)("div",{style:{zIndex:c},className:i().modal,children:[n,(0,r.jsxs)("div",{className:i()["footer-btn"],children:[l&&u&&(0,r.jsx)(a.Z,{bg:"#CC3636",onClick:function(){return l(!0)},placeholder:"Delete"}),(0,r.jsxs)("div",{className:i()["flex-end"],children:[(0,r.jsx)(a.Z,{bg:"gray",onClick:s,placeholder:"Exit"}),u&&(0,r.jsx)(a.Z,{onClick:o,placeholder:d||"submit"})]})]})]})]}):null}},2065:function(e,t,n){"use strict";var r=n(5893),a=n(4136),s=n.n(a);t.Z=function(){return(0,r.jsxs)("div",{className:s().spinner,children:["Loading",(0,r.jsx)("div",{className:s().primary}),(0,r.jsx)("div",{className:s().secondary})]})}},5467:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(5893),a=n(5014),s=n(9473),i=n(8957),o=n.n(i);function l(e){var t=e.rows,n=e.isLoading,i=e.rowCountState,l=e.page,c=e.pageSize,u=e.setPage,d=e.setPageSize,h=e.setSelectedRow,m=e.columns,p=(0,s.I0)();return(0,r.jsx)("div",{className:o().table,children:(0,r.jsx)(a._,{autoHeight:!0,rows:t,rowCount:i,loading:n,rowsPerPageOptions:[10,5],pagination:!0,page:l,pageSize:c,paginationMode:"server",onPageChange:function(e){p(u(e))},onSelectionModelChange:function(e){h(e[0])},onPageSizeChange:function(e){p(d(e))},columns:m})})}},5356:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var r=n(5893),a=n(7568),s=n(4924),i=n(6042),o=n(9396),l=n(655),c=n(9725),u=n(5467),d=n(6430),h=n.n(d),m=n(9473),p=n(217),f=n(7294),x=n(8858),v=n(1163),j=n(9501),g=n(8895),N=n.n(g);var _=function(e){var t=e.ticketInfo,n=e.info;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"titre"}),(0,r.jsx)("input",{className:N().input,type:"text",onChange:t,placeholder:"title",name:"title",value:(null===n||void 0===n?void 0:n.title)?null===n||void 0===n?void 0:n.title:""})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Description"}),(0,r.jsx)("textarea",{onChange:t,className:N().input,name:"description",maxLength:255,rows:30,value:(null===n||void 0===n?void 0:n.description)?null===n||void 0===n?void 0:n.description:""})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Category"}),(0,r.jsxs)("select",{name:"category",className:N().input,onChange:t,defaultValue:n.category||"select",children:[(0,r.jsx)("option",{value:"select",children:"Select a category"}),(0,r.jsx)("option",{value:"Laptop / PC requirement issue",children:"Laptop / PC requirement issue"}),(0,r.jsx)("option",{value:"Laptop / PC software issue",children:"Laptop / PC software issue"}),(0,r.jsx)("option",{value:"Other...",children:"Other..."})]})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Urgent"}),(0,r.jsxs)("select",{name:"urgent",className:N().input,onChange:t,children:[(0,r.jsx)("option",{value:"0",children:"Non"}),(0,r.jsx)("option",{value:"1",children:"Yes"})]})]})]})};var C=function(e){var t=e.id,n=e.ticketInfo,a=e.setIsOwner,s=e.isOwner,i=e.info,o=(0,m.v9)((function(e){return e.ticket})).ticket,l=(0,m.v9)((function(e){return e.auth})).user,c=o.find((function(e){return e.id==t})),u=c.User,d=c.title,h=c.description,p=c.urgent,x=c.status,v=c.creator,j=c.category,g=c.solution;return(0,f.useEffect)((function(){a(l.idUser===v),"Admin"===l.role&&a(!0)}),[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Creator"}),(0,r.jsx)("input",{className:N().input,type:"text",onChange:n,placeholder:"Creator",name:"creator",disabled:!0,value:u})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Title"}),(0,r.jsx)("input",{className:N().input,type:"text",onChange:n,placeholder:"titre",name:"title",defaultValue:d,disabled:!s})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Description"}),(0,r.jsx)("textarea",{onChange:n,className:N().input,name:"description",maxLength:255,rows:30,defaultValue:h,disabled:!s})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Urgent"}),(0,r.jsxs)("select",{name:"urgent",className:N().input,onChange:n,defaultValue:p?"1":"0",disabled:!s,children:[(0,r.jsx)("option",{value:"0",children:"No"}),(0,r.jsx)("option",{value:"1",children:"Yes"})]})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Category"}),(0,r.jsxs)("select",{name:"category",className:N().input,onChange:n,disabled:!s,defaultValue:i.category||j,children:[(0,r.jsx)("option",{value:"Laptop / PC requirement issue",children:"Laptop / PC requirement issue"}),(0,r.jsx)("option",{value:"Laptop / PC software issue",children:"Laptop / PC software issue"}),(0,r.jsx)("option",{value:"Other...",children:"Other..."})]})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"status"}),(0,r.jsxs)("select",{name:"status",className:N().input,onChange:n,defaultValue:i.status||x,disabled:"Admin"!==l.role,children:[(0,r.jsx)("option",{value:"Not Started",children:"Not Started"}),(0,r.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,r.jsx)("option",{value:"Completed",children:"Completed"}),(0,r.jsx)("option",{value:"Postpone",children:"Postpone"})]})]}),("Completed"===x||"Completed"===i.status)&&(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Solution"}),(0,r.jsx)("textarea",{onChange:n,className:N().input,name:"solution",maxLength:255,rows:30,defaultValue:g===(!i.solution&&"The Admin will try to find a solution for the issue as soon as possible.")?"":i.solution||g,disabled:"Admin"!==l.role})]})]})},w=n(5678),b=n(4364),y=n(2065);var S=function(e){var t=e.ticketInfo,n=e.startDate;return console.log(n),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{children:"Filter"}),(0,r.jsx)("hr",{className:N().hr}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Creator"}),(0,r.jsx)("input",{className:N().input,type:"text",placeholder:"search by creator",name:"creator",onChange:t})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"status"}),(0,r.jsxs)("select",{name:"status",className:N().input,defaultValue:"select",onChange:t,children:[(0,r.jsx)("option",{value:"select",disabled:!0,children:"select"}),(0,r.jsx)("option",{value:"Not Started",children:"Not Started"}),(0,r.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,r.jsx)("option",{value:"Completed",children:"Completed"}),(0,r.jsx)("option",{value:"Postpone",children:"Postpone"})]})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Category"}),(0,r.jsxs)("select",{name:"category",className:N().input,defaultValue:"select",onChange:t,children:[(0,r.jsx)("option",{value:"select",disabled:!0,children:"select"}),(0,r.jsx)("option",{value:"Laptop / PC requirement issue",children:"Laptop / PC requirement issue"}),(0,r.jsx)("option",{value:"Laptop / PC software issue",children:"Laptop / PC software issue"}),(0,r.jsx)("option",{value:"Other...",children:"Other..."})]})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"Urgent"}),(0,r.jsxs)("select",{name:"urgent",className:N().input,defaultValue:"select",onChange:t,children:[(0,r.jsx)("option",{value:"select",disabled:!0,children:"select"}),(0,r.jsx)("option",{value:"0",children:"Non"}),(0,r.jsx)("option",{value:"1",children:"Yes"})]})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"From"}),(0,r.jsx)("input",{className:N().input,type:"date",placeholder:"start date",name:"startDate",onChange:t})]}),(0,r.jsxs)("div",{className:N()["form-control"],children:[(0,r.jsx)("label",{children:"To"}),(0,r.jsx)("input",{className:N().input,type:"date",placeholder:"end date",name:"endDate",min:n,onChange:t})]})]})},P=n(5014),k=!0;var Z=function(){var e=(0,m.v9)((function(e){return e.ticket})),t=e.ticket,n=e.total,d=e.page,g=e.pageSize,N=e.isLoading,Z=e.filtering,A=(0,m.v9)((function(e){return e.auth})).user,I=(0,f.useState)(!1),O=I[0],L=I[1],D=(0,f.useState)(!1),F=D[0],E=D[1],z=(0,f.useState)(),T=z[0],U=z[1],V=(0,f.useState)(!1),Y=V[0],q=V[1],R=(0,f.useState)(null),M=R[0],J=R[1],X=(0,f.useState)({}),H=X[0],B=X[1],K=(0,v.useRouter)(),W=(0,m.I0)();(0,f.useEffect)((function(){return"object"!=typeof localStorage.getItem("user")&&localStorage.getItem("user")||K.replace("/login"),localStorage.getItem("user")&&!A&&W((0,x.II)(JSON.parse(localStorage.getItem("user")))),k=!1,function(){W((0,p.mc)())}}),[W,A,K]),(0,f.useEffect)((function(){return A&&W((0,p.NY)({page:d,limit:g})).unwrap().then((function(e){w.Am.success(e.message)})).catch((function(e){w.Am.error(e.message)})),function(){W((0,p.mc)())}}),[A,d,g]);var G=function(){var e=(0,a.Z)((function(){return(0,l.__generator)(this,(function(e){return W((0,p.ax)(H)).unwrap().then((function(e){w.Am.success(e.message),W((0,p.NY)()),B({}),L(!1)})).catch((function(e){w.Am.error(e)})),[2]}))}));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=(0,a.Z)((function(){var e,t;return(0,l.__generator)(this,(function(n){return e={},t={},W((0,p.O)((0,o.Z)((0,i.Z)(e,H),(t.id=M,t)))).unwrap().then((function(e){w.Am.success("Ticket was updated successfully"),W((0,p.NY)({page:d,limit:g})),B({}),J(null)})).catch((function(e){w.Am.error(e)})),[2]}))}));return function(){return e.apply(this,arguments)}}(),$=function(){var e=(0,a.Z)((function(){return(0,l.__generator)(this,(function(e){return W((0,p.M4)(M)).then((function(e){w.Am.success("Ticket was deleted successfully"),q(!1),J(null),W((0,p.NY)({page:d,limit:g}))})).catch((function(e){w.Am.error(e)})),[2]}))}));return function(){return e.apply(this,arguments)}}(),ee=function(e){B((function(t){return(0,o.Z)((0,i.Z)({},t),(0,s.Z)({},e.target.name,e.target.value))}))};return k||N?(0,r.jsx)(y.Z,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:h().right,children:[(0,r.jsx)("h3",{children:"Tickets"}),(0,r.jsxs)("div",{className:h().end,children:[(0,r.jsx)(c.Z,{classN:"btn",color:"white",onClick:function(){return L(!0)},placeholder:"Create Ticket"}),(0,r.jsx)(c.Z,{classN:"btn",color:"white",onClick:function(){return E(!0)},placeholder:"Filter"})]})]}),Z?(0,r.jsx)(P._,{autoHeight:!0,rowsPerPageOptions:[10],columns:b.R4,pageSize:10,rows:t}):(0,r.jsx)(u.Z,{rows:t,isLoading:N,rowCountState:n,page:d,pageSize:g,setPage:p.YA,setPageSize:p.U5,setSelectedRow:J,columns:b.R4}),(0,r.jsx)(j.Z,{open:Y,onClose:function(){return q(!1)},z:200,submit:$,isOwner:T,children:(0,r.jsx)("h4",{children:"You sure about removing that record!"})}),(0,r.jsx)(j.Z,{open:M,onClose:function(){return J(null)},submit:Q,setRemove:q,isOwner:T,children:(0,r.jsx)(C,{id:M,ticketInfo:ee,info:H,setIsOwner:U,isOwner:T})}),(0,r.jsx)(j.Z,{submit:G,open:O,onClose:function(){return L(!1)},isOwner:!0,children:(0,r.jsx)(_,{ticketInfo:ee,info:H})}),(0,r.jsx)(j.Z,{submit:function(){var e=H.creator,t=H.status,n=H.category,r=H.startDate,a=H.endDate,s=H.urgent;if(!e&&!t&&!n&&!r&&!a&&!s)return w.Am.warning("Please you must provide a field at least!");W((0,p.lE)(H)).unwrap().then((function(e){w.Am.success(e.message),B({}),E(!1)})).catch((function(e){w.Am.error(e)}))},open:F,onClose:function(){return E(!1)},isOwner:!0,btnTxt:"Filter",children:(0,r.jsx)(S,{ticketInfo:ee,startDate:H.startDate})})]})};var A=function(){return(0,r.jsx)(Z,{})}},4364:function(e,t,n){"use strict";n.d(t,{R4:function(){return a},Sf:function(){return s},iL:function(){return i}});var r=n(5089),a=[{field:"id",headerName:"ID",width:20},{field:"title",headerName:"Title",width:130},{field:"description",headerName:"Description",width:300},{field:"User",headerName:"Creator",width:80},{field:"urgent",headerName:"Urgent",width:70,valueFormatter:function(e){return e.value?"YES":"NO"}},{field:"status",headerName:"Status",width:120},{field:"category",headerName:"Category",width:120},{field:"solution",headerName:"Solution",width:180},{field:"createdAt",headerName:"Created At",type:"date",width:100,valueFormatter:function(e){return(0,r.Z)(new Date(e.value))}},{field:"updatedAt",headerName:"Updated At",type:"date",width:100,valueFormatter:function(e){return(0,r.Z)(new Date(e.value))}}],s=[{field:"id",headerName:"ID",width:100},{field:"fullName",headerName:"Full Name",width:130},{field:"email",headerName:"Email",width:230},{field:"role",headerName:"Role",width:100},{field:"createdAt",headerName:"Created At",type:"date",width:180,valueFormatter:function(e){return(0,r.Z)(new Date(e.value))}},{field:"updatedAt",headerName:"Updated At",type:"date",width:180,valueFormatter:function(e){return(0,r.Z)(new Date(e.value))}}],i=["January","February","March","April","May","June","July","August","September","October","November","December"]},8895:function(e){e.exports={hr:"ticket-form_hr__0rXjM","form-control":"ticket-form_form-control__Td6_C",input:"ticket-form_input__J2v0t"}},6430:function(e){e.exports={right:"ticket_right__ejEmN",end:"ticket_end__OmN4x"}},2892:function(e){e.exports={btn:"button_btn__4KBe5",reverse:"button_reverse__Px7uH"}},6591:function(e){e.exports={modal:"modal_modal__kZrya",overlay:"modal_overlay__ayacu","footer-btn":"modal_footer-btn__rT9ML","flex-end":"modal_flex-end__fq18W"}},4136:function(e){e.exports={spinner:"spinner_spinner__fEcEZ","text-color":"spinner_text-color__4zX9q",rotate:"spinner_rotate__qewNB",primary:"spinner_primary__LI3fL",secondary:"spinner_secondary__XvO1n"}},8957:function(e){e.exports={table:"table_table__MzAii"}}},function(e){e.O(0,[89,331,774,888,179],(function(){return t=8471,e(e.s=t);var t}));var t=e.O();_N_E=t}]);